---
title: "Psychosocial Dimensions of Student Life Report"
output:
  prettydoc::html_pretty:
    theme: architect
author: "Lindolfo Cavalcanti"
date: "2024/07"
---

```{r include=FALSE}
library(tidyverse)
library(dlookr)
library(flextable)
library(missRanger)
library(SmartEDA)
library(DataExplorer)
```

```{r include=FALSE}
data_student = read_csv("/home/lindo/Documents/Kaggle/Psychosocial Dimensions of Student Life/CSE_student_performances.csv")
```

```{r include=FALSE}
data_student$Gender = data_student$Gender %>% as.factor()
data_student$AcademicPerformance = data_student$AcademicPerformance %>% as.factor()
data_student$TakingNoteInClass = data_student$TakingNoteInClass %>% as.factor()
data_student$DepressionStatus = data_student$DepressionStatus %>% as.factor()
data_student$FaceChallangesToCompleteAcademicTask = data_student$FaceChallangesToCompleteAcademicTask %>% as.factor()
data_student$LikePresentation = data_student$LikePresentation %>% as.factor()
data_student$LikeNewThings= data_student$LikeNewThings %>% as.factor()

str(data_student)
```

# Introduction

# Data Exploration

```{r echo=FALSE}
discriptive1 = ExpData(data=data_student,type=2) %>% as.data.frame() 

ft_discriptive = discriptive1 %>% flextable()

ft_discriptive <- ft_discriptive %>%
  set_header_labels(Age = "Age (Years)", Variable_Type = "Class", Sample_n = "Sample", Missing_Count = "NA Values", Per_of_Missing = "Percentage of NA", No_of_distinct_values = "Distinct Values") %>% 
  theme_vanilla() %>%
  fontsize(size = 10, part = "all") %>%
  bold(part = "header") %>%
  color(part = "header", color = "white") %>%
  bg(part = "header", bg = "#007fff") %>%
  align(part = "all", align = "center") %>%
  autofit()

ft_discriptive <- set_caption(ft_discriptive, caption = "Variables Characteristics
")

ft_discriptive 
```

```{r echo=FALSE}
ft_diagnose = dlookr::diagnose_category(data_student) %>% flextable()

ft_diagnose <- ft_diagnose %>%
  set_header_labels(variables = "Variables", levels = "Levels", N = "Sample", freq = "Frequency", ratio = "Ratio", rank = "Rank") %>% 
  theme_vanilla() %>%
  fontsize(size = 10, part = "all") %>%
  bold(part = "header") %>%
  color(part = "header", color = "white") %>%
  bg(part = "header", bg = "#007fff") %>%
  align(part = "all", align = "center") %>%
  autofit()

ft_diagnose <- set_caption(ft_diagnose, caption = "Variables Diagnose")

ft_diagnose
```

```{r echo=FALSE}
dlookr::plot_bar_category(data_student, DepressionStatus)
```

# Data Cleaning

## Removing NA values

```{r include=FALSE}
data_student <- data_student %>%
  filter(!is.na(NumberOfFriend))

data_student %>% is.na() %>% colSums()

unique(data_student$NumberOfFriend)
```

## Removing Outliers

```{r echo=FALSE}
ft_outliers = dlookr::diagnose_outlier(data_student) %>% flextable()

ft_outliers <- ft_outliers %>% 
  set_header_labels(variables = "Variables", outliers_cnt = "N. Outliers", ouliers_ratio = "outliers Ratio", outliers_mean = "Outliers Mean", with_mean = "With Outliers Mean", without_mean= "Without Outliers Mean", rank = "Rank") %>% 
  theme_vanilla() %>%
  fontsize(size = 10, part = "all") %>%
  bold(part = "header") %>%
  color(part = "header", color = "white") %>%
  bg(part = "header", bg = "#007fff") %>%
  align(part = "all", align = "center") %>%
  autofit()

ft_outliers = set_caption(ft_outliers, caption = "Outliers Diagnose")

ft_outliers
```

```{r echo=FALSE}
dlookr::plot_outlier(data_student, NumberOfFriend)
```

```{r echo=FALSE}
outliers_limit = boxplot.stats(data_student$NumberOfFriend)$stats[5]

data_student <- data_student %>%
  filter(data_student$NumberOfFriend < outliers_limit)
```

```{r echo=FALSE}
ggplot(data_student, aes(y = NumberOfFriend)) +
  geom_boxplot(fill = "#007fff") +
  labs(title = "Boxplot of Number of Friends",
       y = "Number of Friends") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    axis.title.y = element_text(size = 14)
  )
```

# Data Analysis

## Normality Tests

```{r echo=FALSE}
dlookr::plot_normality(data_student)
```

```{r echo=FALSE}
ft_normality = dlookr::normality(data_student) %>% flextable()

ft_normality <- ft_normality %>% 
   set_header_labels(vars = "Variables", statistic = "Statistic", p_value = "P value", sample = "Sample") %>% 
  theme_vanilla() %>%
  fontsize(size = 10, part = "all") %>%
  bold(part = "header") %>%
  color(part = "header", color = "white") %>%
  bg(part = "header", bg = "#007fff") %>%
  align(part = "all", align = "center") %>%
  autofit()

ft_normality = set_caption(ft_normality, caption = "Normality Test to Numeric Variables")

ft_normality
```

```{r echo=FALSE}
DataExplorer::plot_bar(data_student)
```

# Depression Status Correlations

```{r echo=FALSE}
DataExplorer::plot_scatterplot(data_student, by = "DepressionStatus", sampled_rows = nrow(data_student), nrow = 3L, ncol = 3L, parallel = FALSE)
```

```{r echo=FALSE}
ft_compare_gender = dlookr::compare_category(data_student, target = "Gender", explain = "DepressionStatus")

ft_compare_gender = ft_compare_gender %>% as.data.frame() %>% flextable()

ft_compare_gender = ft_compare_gender <- ft_compare_gender %>% 
  set_header_labels(Gender.vs.DepressionStatus.Gender = "Gender", Gender.vs.DepressionStatus.DepressionStatus = "Depression Status", Gender.vs.DepressionStatus.n = "Occurrences", Gender.vs.DepressionStatus.rate = "Rate", Gender.vs.DepressionStatus.var1_rate = "Gender", Gender.vs.DepressionStatus.var2_rate = "Depression Status Rate") %>% 
  theme_vanilla() %>%
  fontsize(size = 10, part = "all") %>%
  bold(part = "header") %>%
  color(part = "header", color = "white") %>%
  bg(part = "header", bg = "#007fff") %>%
  align(part = "all", align = "center") %>%
  autofit()

ft_compare_gender = set_caption(ft_compare_gender, caption = "Comparation Between Gender and Depression Status")

ft_compare_gender
```

```{r echo=FALSE}
ft_compare_challange = dlookr::compare_category(data_student, target = "FaceChallangesToCompleteAcademicTask", explain = "DepressionStatus")

ft_compare_challange = ft_compare_challange %>% as.data.frame() %>% flextable()

ft_compare_challange = ft_compare_challange <- ft_compare_challange %>% 
  set_header_labels(FaceChallangesToCompleteAcademicTask.vs.DepressionStatus.FaceChallangesToCompleteAcademicTask = "Challanges to Complete Task", FaceChallangesToCompleteAcademicTask.vs.DepressionStatus.DepressionStatus = "Depression Status", FaceChallangesToCompleteAcademicTask.vs.DepressionStatus.n = "Occorrances", FaceChallangesToCompleteAcademicTask.vs.DepressionStatus.rate = "Rate", FaceChallangesToCompleteAcademicTask.vs.DepressionStatus.var1_rate = "Challange to Complete Task Rate", FaceChallangesToCompleteAcademicTask.vs.DepressionStatus.var2_rate = "Depression Status Rate") %>% 
  theme_vanilla() %>%
  fontsize(size = 10, part = "all") %>%
  bold(part = "header") %>%
  color(part = "header", color = "white") %>%
  bg(part = "header", bg = "#007fff") %>%
  align(part = "all", align = "center") %>%
  autofit()

ft_compare_challange = set_caption(ft_compare_challange, caption = "Comparation Between Challange to Complete Tasks and Depression Status")


ft_compare_challange
```

```{r echo=FALSE}
bar_plot_test = DataExplorer::plot_bar(data = data_student, by = "DepressionStatus")
```

```{r echo=FALSE}
ggplot(data_student) +
 aes(x = Gender, fill = DepressionStatus) +
 geom_bar() +
 coord_flip() +
 theme_minimal()+labs(title = "Relationship Between Gender and Depression Status")
```

```{r echo=FALSE}
ggplot(data_student) +
 aes(x = FaceChallangesToCompleteAcademicTask, fill = DepressionStatus) +
 geom_bar() +
 coord_flip() +
 theme_minimal()+labs(title = "Relationship Between Face Challanges to Complete Taks and Depression")
```

Statistical tests between Depression Status, Gender and Challenge to Complete Tasks

```{r echo=FALSE}
gender_depression = table(c(data_student$Gender, data_student$DepressionStatus)) 

chi_squared_gender_depression <- chisq.test(gender_depression)

ft_chi_gender = broom::tidy(chi_squared_gender_depression) %>% flextable()

ft_chi_gender = ft_chi_gender %>%
  set_header_labels(statistic = "X Squared", p.value = "P-Value", parameter = "Degrees of Freedom", method = "Method") %>% 
  theme_vanilla() %>%
  fontsize(size = 10, part = "all") %>%
  bold(part = "header") %>%
  color(part = "header", color = "white") %>%
  bg(part = "header", bg = "#007fff") %>%
  align(part = "all", align = "center") %>%
  autofit()

ft_chi_gender = set_caption(ft_chi_gender, caption = "Chi-Squared Test for Gender and Depression Status")

ft_chi_gender
```

```{r echo=FALSE}
challange_depression = table(c(data_student$FaceChallangesToCompleteAcademicTask, data_student$DepressionStatus)) 

chi_squared_challange_depression <- chisq.test(challange_depression)

ft_chi_challange = broom::tidy(chi_squared_challange_depression) %>% flextable()

ft_chi_challange= ft_chi_challange%>%
  set_header_labels(statistic = "X Squared", p.value = "P-Value", parameter = "Degrees of Freedom", method = "Method") %>% 
  theme_vanilla() %>%
  fontsize(size = 10, part = "all") %>%
  bold(part = "header") %>%
  color(part = "header", color = "white") %>%
  bg(part = "header", bg = "#007fff") %>%
  align(part = "all", align = "center") %>%
  autofit()

ft_chi_challange= set_caption(ft_chi_challange, caption = "Chi-Squared Test for Challange to Complete Tasks and Depression Status")

ft_chi_challange

chi_squared_challange_depression
```

# Conclusion

# Contact

Email: [lindolfoj47.lj\@gmail.com](mailto:lindolfoj47.lj@gmail.com){.email}

Linkedin: [www.linkedin.com/in/ lindolfo-cavalcanti](www.linkedin.com/in/ lindolfo-cavalcanti)

GitHub: <https://github.com/Lindolfo-Cavalcanti>

Kaggle: <https://www.kaggle.com/lindolfocavalcanti>
